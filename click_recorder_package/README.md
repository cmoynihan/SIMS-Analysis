# SIMS-Analysis
The SIMS-Analysis program allows the user to record a series of clicks and to use these recordings to quickly make python scripts that manipulate the mouse using the **pyautogui** module. This is essential since some applications lack features that allow the user to quickly execute large operations, such as exporting thousands of images.
This repository contains two main scripts. The first is a GUI that allows the user to easily and quickly record series of clicks to a .csv file and to play those clicks back using the **pyautogui** module. The second script reads recordings made by the first, reproduces them with the mouse, and inputs text where desired.
## Important Things To Know
### pyautogui.FAILSAFE
One issue with pyautogui programs is that they can cause a lot of damage is you let them run where they aren't supposed to. For example, pyautogui can mess up your code by clicking and typing/deleting things in your development environment (i.e. VIM). pyautogui.FAILSAFE is a feature which, when turned on, allows the user to terminate the program by mousing up to the top left corner of the screen. Otherwise, the user will have no way of ending the program as the computer will have control over the mouse.
### pyautogui.PAUSE
pyautogui.PAUSE allows the user to control the delay between pyautogui calls. It is highly recommended that the user sets this to a value to 0.5 or greater during testing so that the program cannot inflict a lot of damage if it does not execute as planned. Once you are confident that the program works, you can reduce pyautogui.PAUSE to a lower value. 
I would caution against setting pyautogui.PAUSE to 0 if you are executing complex clickstrokes, as your computer will need time to execute the instructions being given to it by your clicks, and having no delay between your clicks can create a lot of confusion for the program on which they are being executed.
## recorderGUI.py
The first of the two main programs is the click recording graphical user interface, recorderGUI. This interface provides a way for the user to record the positions of clicks on the screen to a .csv file. The interface has seven components: an entry box labeled "Input File Name," and six buttons, labeled "Record," "Stop," "Pause," "Play," "Clear," and "Add Text Marker."
### Making Recordings
To make a recording, type in what you would like your file to be called in the Input File Name entry box, **without the .csv extension**, then press Record. If you would like to overwrite a preexisting file, simply type in that file's name, and a dialog will appear asking you to confirm. After pressing Record, the locations of your clicks will be written to this file until you press Pause or Stop. If you press Pause, recorderGUI will not record your clicks until you resume your recording by pressing Record.
recorderGUI has the capability to record left and right clicks. It cannot record double clicks. If you would like to indicate to the recorder that the last click represents a location where you will enter text, click Add Text Marker. This will add a line to the .csv click recording file, indicating that this is a place where text should be entered. The user can specify the text to be entered in the control script that reads the recording file (see below).
### Playing Back Recordings
If you would like to play back your recording, type in the file name of the recording and click Play. Play uses the pyautogui module to repeat the clickstroke represented by the coordinates in the file. This is useful for testing, as it lets the user determine whether the recording will have the desired effect. Once you are satisfied with the recording, click Clear to clear the entry box if you would like to make another, or close the program.
## controlScript.py
controlScript.py uses recordings made with recorderGUI.py and pyautogui to perform a series of left clicks, right clicks, and text entries. It does this with three  functions:
### readClicks(clickfile)
readClicks() reads a .csv file (clickfile) produced by recorderGUI.py and executes a series of pyautogui clicks based on the data stored in that file. The function reads data about where on the screen the click occurred, and whether it was a left or right click; it then executes the corresponding action. If readClicks() detects a text marker in the data file (added with Add Text Marker button in the Recorder GUI), then it will insert text at that position by calling clearEntry() and then inputText(). It then increments the textInstance variable so that the inputText() function can type in different messages into each text box it encounters during program execution (see inputText()).
### clearEntry(entryLocation)
clearEntry() is designed to clear text boxes. It does this by executing pyautogui.doubleClick() at the entryLocation, selecting all the text, and then pressing the backspace key to remove it.
### inputText(textInstance)
inputText() tells python what message to enter into the text box whenever readClicks() detects a text marker in the recording .csv file (this button is added when the user clicks Add Text Marker during recording). Each time readClicks() detects a text marker, it calls inputText() with a new value for textInstance. The inputText() function has logic which determines what to write based on the textInstance. Thus, if you want to input a message into one text box and want input a different message into a second, you can use the textInstance input parameter to vary the message that inputText() writes, based on when it is called. 

